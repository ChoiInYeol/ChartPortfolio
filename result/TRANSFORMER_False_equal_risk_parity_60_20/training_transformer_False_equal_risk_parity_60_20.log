Configuration: {'START': '2001-01-01', 'END': '2024-09-01', 'N_STOCK': 50, 'LEN_DATA': 5000, 'TRAIN_LEN': 60, 'PRED_LEN': 20, 'TRAIN_RATIO': 0.6, 'VAL_RATIO': 0.2, 'TEST_RATIO': 0.2, 'RESULT_DIR': 'result/TRANSFORMER_False_equal_risk_parity_60_20', 'MODELS': ['GRU', 'TCN', 'TRANSFORMER'], 'MULTIMODAL_OPTIONS': [False], 'LOSS_FUNCTIONS': ['max_sharpe', 'equal_risk_parity', 'mean_variance'], 'TRAIN_LEN_OPTIONS': [60], 'PRED_LEN_OPTIONS': [20], 'SEED': 42, 'BATCH': 32, 'EPOCHS': 500, 'EARLY_STOP': 20, 'MIN_DELTA': 0.0001, 'LR': 0.005, 'MOMENTUM': 0.9, 'USE_CUDA': True, 'LB': 0, 'UB': 0.2, 'N_FEAT': 50, 'BETA': 0.2, 'LOSS_FUNCTION': 'equal_risk_parity', 'TCN': {'n_output': 50, 'kernel_size': 4, 'n_dropout': 0.1, 'n_timestep': 60, 'hidden_size': 64, 'level': 3}, 'GRU': {'n_layers': 1, 'hidden_dim': 128, 'dropout_p': 0.3, 'bidirectional': False}, 'TRANSFORMER': {'n_timestep': 60, 'n_layer': 6, 'n_head': 5, 'n_dropout': 0.1, 'n_output': 50}, 'MODEL': 'TRANSFORMER', 'MULTIMODAL': False}
Model: transformer, Multimodal: False, Loss Function: equal_risk_parity
Loading and processing data...
Epoch 1/500, Training Loss: 0.023939
Epoch 1/500, Validation Loss: 0.017463
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_1_loss_0.0175.pth
Validation loss improved. Early stop count reset to 0.
Epoch 2/500, Training Loss: 0.012133
Epoch 2/500, Validation Loss: 0.014761
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_2_loss_0.0148.pth
Validation loss improved. Early stop count reset to 0.
Epoch 3/500, Training Loss: 0.010660
Epoch 3/500, Validation Loss: 0.013485
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_3_loss_0.0135.pth
Validation loss improved. Early stop count reset to 0.
Epoch 4/500, Training Loss: 0.009704
Epoch 4/500, Validation Loss: 0.012840
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_4_loss_0.0128.pth
Validation loss improved. Early stop count reset to 0.
Epoch 5/500, Training Loss: 0.009151
Epoch 5/500, Validation Loss: 0.012380
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_5_loss_0.0124.pth
Validation loss improved. Early stop count reset to 0.
Epoch 6/500, Training Loss: 0.008757
Epoch 6/500, Validation Loss: 0.011977
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_6_loss_0.0120.pth
Validation loss improved. Early stop count reset to 0.
Epoch 7/500, Training Loss: 0.008473
Epoch 7/500, Validation Loss: 0.011708
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_7_loss_0.0117.pth
Validation loss improved. Early stop count reset to 0.
Epoch 8/500, Training Loss: 0.008219
Epoch 8/500, Validation Loss: 0.011511
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_8_loss_0.0115.pth
Validation loss improved. Early stop count reset to 0.
Epoch 9/500, Training Loss: 0.008000
Epoch 9/500, Validation Loss: 0.011312
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_9_loss_0.0113.pth
Validation loss improved. Early stop count reset to 0.
Epoch 10/500, Training Loss: 0.007862
Epoch 10/500, Validation Loss: 0.011158
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_10_loss_0.0112.pth
Validation loss improved. Early stop count reset to 0.
Epoch 11/500, Training Loss: 0.007730
Epoch 11/500, Validation Loss: 0.011054
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_11_loss_0.0111.pth
Validation loss improved. Early stop count reset to 0.
Epoch 12/500, Training Loss: 0.007589
Epoch 12/500, Validation Loss: 0.010893
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_12_loss_0.0109.pth
Validation loss improved. Early stop count reset to 0.
Epoch 13/500, Training Loss: 0.007479
Epoch 13/500, Validation Loss: 0.010865
No significant improvement in validation loss. Early stop count: 1
Epoch 14/500, Training Loss: 0.007355
Epoch 14/500, Validation Loss: 0.010685
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_14_loss_0.0107.pth
Validation loss improved. Early stop count reset to 0.
Epoch 15/500, Training Loss: 0.007216
Epoch 15/500, Validation Loss: 0.010465
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_15_loss_0.0105.pth
Validation loss improved. Early stop count reset to 0.
Epoch 16/500, Training Loss: 0.007056
Epoch 16/500, Validation Loss: 0.010362
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_16_loss_0.0104.pth
Validation loss improved. Early stop count reset to 0.
Epoch 17/500, Training Loss: 0.006933
Epoch 17/500, Validation Loss: 0.010152
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_17_loss_0.0102.pth
Validation loss improved. Early stop count reset to 0.
Epoch 18/500, Training Loss: 0.006764
Epoch 18/500, Validation Loss: 0.010006
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_18_loss_0.0100.pth
Validation loss improved. Early stop count reset to 0.
Epoch 19/500, Training Loss: 0.006574
Epoch 19/500, Validation Loss: 0.009817
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_19_loss_0.0098.pth
Validation loss improved. Early stop count reset to 0.
Epoch 20/500, Training Loss: 0.006424
Epoch 20/500, Validation Loss: 0.009582
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_20_loss_0.0096.pth
Validation loss improved. Early stop count reset to 0.
Epoch 21/500, Training Loss: 0.006253
Epoch 21/500, Validation Loss: 0.009393
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_21_loss_0.0094.pth
Validation loss improved. Early stop count reset to 0.
Epoch 22/500, Training Loss: 0.006116
Epoch 22/500, Validation Loss: 0.009253
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_22_loss_0.0093.pth
Validation loss improved. Early stop count reset to 0.
Epoch 23/500, Training Loss: 0.006014
Epoch 23/500, Validation Loss: 0.009122
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_23_loss_0.0091.pth
Validation loss improved. Early stop count reset to 0.
Epoch 24/500, Training Loss: 0.005928
Epoch 24/500, Validation Loss: 0.009010
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_24_loss_0.0090.pth
Validation loss improved. Early stop count reset to 0.
Epoch 25/500, Training Loss: 0.005873
Epoch 25/500, Validation Loss: 0.008956
No significant improvement in validation loss. Early stop count: 1
Epoch 26/500, Training Loss: 0.005804
Epoch 26/500, Validation Loss: 0.008909
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_26_loss_0.0089.pth
Validation loss improved. Early stop count reset to 0.
Epoch 27/500, Training Loss: 0.005748
Epoch 27/500, Validation Loss: 0.008902
No significant improvement in validation loss. Early stop count: 1
Epoch 28/500, Training Loss: 0.005705
Epoch 28/500, Validation Loss: 0.008828
No significant improvement in validation loss. Early stop count: 2
Epoch 29/500, Training Loss: 0.005674
Epoch 29/500, Validation Loss: 0.008778
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_29_loss_0.0088.pth
Validation loss improved. Early stop count reset to 0.
Epoch 30/500, Training Loss: 0.005621
Epoch 30/500, Validation Loss: 0.008742
No significant improvement in validation loss. Early stop count: 1
Epoch 31/500, Training Loss: 0.005579
Epoch 31/500, Validation Loss: 0.008704
No significant improvement in validation loss. Early stop count: 2
Epoch 32/500, Training Loss: 0.005541
Epoch 32/500, Validation Loss: 0.008650
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_32_loss_0.0086.pth
Validation loss improved. Early stop count reset to 0.
Epoch 33/500, Training Loss: 0.005512
Epoch 33/500, Validation Loss: 0.008638
No significant improvement in validation loss. Early stop count: 1
Epoch 34/500, Training Loss: 0.005461
Epoch 34/500, Validation Loss: 0.008607
No significant improvement in validation loss. Early stop count: 2
Epoch 35/500, Training Loss: 0.005426
Epoch 35/500, Validation Loss: 0.008568
No significant improvement in validation loss. Early stop count: 3
Epoch 36/500, Training Loss: 0.005390
Epoch 36/500, Validation Loss: 0.008519
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_36_loss_0.0085.pth
Validation loss improved. Early stop count reset to 0.
Epoch 37/500, Training Loss: 0.005353
Epoch 37/500, Validation Loss: 0.008493
No significant improvement in validation loss. Early stop count: 1
Epoch 38/500, Training Loss: 0.005339
Epoch 38/500, Validation Loss: 0.008455
No significant improvement in validation loss. Early stop count: 2
Epoch 39/500, Training Loss: 0.005302
Epoch 39/500, Validation Loss: 0.008419
No significant improvement in validation loss. Early stop count: 3
Epoch 40/500, Training Loss: 0.005281
Epoch 40/500, Validation Loss: 0.008388
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_40_loss_0.0084.pth
Validation loss improved. Early stop count reset to 0.
Epoch 41/500, Training Loss: 0.005250
Epoch 41/500, Validation Loss: 0.008362
No significant improvement in validation loss. Early stop count: 1
Epoch 42/500, Training Loss: 0.005208
Epoch 42/500, Validation Loss: 0.008326
No significant improvement in validation loss. Early stop count: 2
Epoch 43/500, Training Loss: 0.005180
Epoch 43/500, Validation Loss: 0.008292
No significant improvement in validation loss. Early stop count: 3
Epoch 44/500, Training Loss: 0.005138
Epoch 44/500, Validation Loss: 0.008274
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_44_loss_0.0083.pth
Validation loss improved. Early stop count reset to 0.
Epoch 45/500, Training Loss: 0.005142
Epoch 45/500, Validation Loss: 0.008238
No significant improvement in validation loss. Early stop count: 1
Epoch 46/500, Training Loss: 0.005097
Epoch 46/500, Validation Loss: 0.008223
No significant improvement in validation loss. Early stop count: 2
Epoch 47/500, Training Loss: 0.005065
Epoch 47/500, Validation Loss: 0.008188
No significant improvement in validation loss. Early stop count: 3
Epoch 48/500, Training Loss: 0.005045
Epoch 48/500, Validation Loss: 0.008161
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_48_loss_0.0082.pth
Validation loss improved. Early stop count reset to 0.
Epoch 49/500, Training Loss: 0.005019
Epoch 49/500, Validation Loss: 0.008152
No significant improvement in validation loss. Early stop count: 1
Epoch 50/500, Training Loss: 0.004998
Epoch 50/500, Validation Loss: 0.008115
No significant improvement in validation loss. Early stop count: 2
Epoch 51/500, Training Loss: 0.004973
Epoch 51/500, Validation Loss: 0.008089
No significant improvement in validation loss. Early stop count: 3
Epoch 52/500, Training Loss: 0.004930
Epoch 52/500, Validation Loss: 0.008075
No significant improvement in validation loss. Early stop count: 4
Epoch 53/500, Training Loss: 0.004924
Epoch 53/500, Validation Loss: 0.008040
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_53_loss_0.0080.pth
Validation loss improved. Early stop count reset to 0.
Epoch 54/500, Training Loss: 0.004913
Epoch 54/500, Validation Loss: 0.008038
No significant improvement in validation loss. Early stop count: 1
Epoch 55/500, Training Loss: 0.004896
Epoch 55/500, Validation Loss: 0.008003
No significant improvement in validation loss. Early stop count: 2
Epoch 56/500, Training Loss: 0.004857
Epoch 56/500, Validation Loss: 0.007992
No significant improvement in validation loss. Early stop count: 3
Epoch 57/500, Training Loss: 0.004850
Epoch 57/500, Validation Loss: 0.007961
No significant improvement in validation loss. Early stop count: 4
Epoch 58/500, Training Loss: 0.004824
Epoch 58/500, Validation Loss: 0.007934
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_58_loss_0.0079.pth
Validation loss improved. Early stop count reset to 0.
Epoch 59/500, Training Loss: 0.004804
Epoch 59/500, Validation Loss: 0.007925
No significant improvement in validation loss. Early stop count: 1
Epoch 60/500, Training Loss: 0.004797
Epoch 60/500, Validation Loss: 0.007916
No significant improvement in validation loss. Early stop count: 2
Epoch 61/500, Training Loss: 0.004794
Epoch 61/500, Validation Loss: 0.007889
No significant improvement in validation loss. Early stop count: 3
Epoch 62/500, Training Loss: 0.004771
Epoch 62/500, Validation Loss: 0.007878
No significant improvement in validation loss. Early stop count: 4
Epoch 63/500, Training Loss: 0.004725
Epoch 63/500, Validation Loss: 0.007853
No significant improvement in validation loss. Early stop count: 5
Epoch 64/500, Training Loss: 0.004721
Epoch 64/500, Validation Loss: 0.007833
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_64_loss_0.0078.pth
Validation loss improved. Early stop count reset to 0.
Epoch 65/500, Training Loss: 0.004694
Epoch 65/500, Validation Loss: 0.007813
No significant improvement in validation loss. Early stop count: 1
Epoch 66/500, Training Loss: 0.004669
Epoch 66/500, Validation Loss: 0.007798
No significant improvement in validation loss. Early stop count: 2
Epoch 67/500, Training Loss: 0.004664
Epoch 67/500, Validation Loss: 0.007767
No significant improvement in validation loss. Early stop count: 3
Epoch 68/500, Training Loss: 0.004641
Epoch 68/500, Validation Loss: 0.007758
No significant improvement in validation loss. Early stop count: 4
Epoch 69/500, Training Loss: 0.004641
Epoch 69/500, Validation Loss: 0.007746
No significant improvement in validation loss. Early stop count: 5
Epoch 70/500, Training Loss: 0.004629
Epoch 70/500, Validation Loss: 0.007725
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_70_loss_0.0077.pth
Validation loss improved. Early stop count reset to 0.
Epoch 71/500, Training Loss: 0.004599
Epoch 71/500, Validation Loss: 0.007720
No significant improvement in validation loss. Early stop count: 1
Epoch 72/500, Training Loss: 0.004590
Epoch 72/500, Validation Loss: 0.007712
No significant improvement in validation loss. Early stop count: 2
Epoch 73/500, Training Loss: 0.004593
Epoch 73/500, Validation Loss: 0.007682
No significant improvement in validation loss. Early stop count: 3
Epoch 74/500, Training Loss: 0.004562
Epoch 74/500, Validation Loss: 0.007672
No significant improvement in validation loss. Early stop count: 4
Epoch 75/500, Training Loss: 0.004558
Epoch 75/500, Validation Loss: 0.007658
No significant improvement in validation loss. Early stop count: 5
Epoch 76/500, Training Loss: 0.004536
Epoch 76/500, Validation Loss: 0.007654
No significant improvement in validation loss. Early stop count: 6
Epoch 77/500, Training Loss: 0.004522
Epoch 77/500, Validation Loss: 0.007640
No significant improvement in validation loss. Early stop count: 7
Epoch 78/500, Training Loss: 0.004513
Epoch 78/500, Validation Loss: 0.007617
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_78_loss_0.0076.pth
Validation loss improved. Early stop count reset to 0.
Epoch 79/500, Training Loss: 0.004507
Epoch 79/500, Validation Loss: 0.007612
No significant improvement in validation loss. Early stop count: 1
Epoch 80/500, Training Loss: 0.004493
Epoch 80/500, Validation Loss: 0.007581
No significant improvement in validation loss. Early stop count: 2
Epoch 81/500, Training Loss: 0.004479
Epoch 81/500, Validation Loss: 0.007579
No significant improvement in validation loss. Early stop count: 3
Epoch 82/500, Training Loss: 0.004472
Epoch 82/500, Validation Loss: 0.007568
No significant improvement in validation loss. Early stop count: 4
Epoch 83/500, Training Loss: 0.004450
Epoch 83/500, Validation Loss: 0.007554
No significant improvement in validation loss. Early stop count: 5
Epoch 84/500, Training Loss: 0.004431
Epoch 84/500, Validation Loss: 0.007545
No significant improvement in validation loss. Early stop count: 6
Epoch 85/500, Training Loss: 0.004441
Epoch 85/500, Validation Loss: 0.007532
No significant improvement in validation loss. Early stop count: 7
Epoch 86/500, Training Loss: 0.004412
Epoch 86/500, Validation Loss: 0.007515
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_86_loss_0.0075.pth
Validation loss improved. Early stop count reset to 0.
Epoch 87/500, Training Loss: 0.004410
Epoch 87/500, Validation Loss: 0.007514
No significant improvement in validation loss. Early stop count: 1
Epoch 88/500, Training Loss: 0.004386
Epoch 88/500, Validation Loss: 0.007495
No significant improvement in validation loss. Early stop count: 2
Epoch 89/500, Training Loss: 0.004389
Epoch 89/500, Validation Loss: 0.007486
No significant improvement in validation loss. Early stop count: 3
Epoch 90/500, Training Loss: 0.004385
Epoch 90/500, Validation Loss: 0.007477
No significant improvement in validation loss. Early stop count: 4
Epoch 91/500, Training Loss: 0.004367
Epoch 91/500, Validation Loss: 0.007467
No significant improvement in validation loss. Early stop count: 5
Epoch 92/500, Training Loss: 0.004356
Epoch 92/500, Validation Loss: 0.007463
No significant improvement in validation loss. Early stop count: 6
Epoch 93/500, Training Loss: 0.004336
Epoch 93/500, Validation Loss: 0.007454
No significant improvement in validation loss. Early stop count: 7
Epoch 94/500, Training Loss: 0.004353
Epoch 94/500, Validation Loss: 0.007434
No significant improvement in validation loss. Early stop count: 8
Epoch 95/500, Training Loss: 0.004331
Epoch 95/500, Validation Loss: 0.007430
No significant improvement in validation loss. Early stop count: 9
Epoch 96/500, Training Loss: 0.004328
Epoch 96/500, Validation Loss: 0.007419
No significant improvement in validation loss. Early stop count: 10
Epoch 97/500, Training Loss: 0.004312
Epoch 97/500, Validation Loss: 0.007412
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_97_loss_0.0074.pth
Validation loss improved. Early stop count reset to 0.
Epoch 98/500, Training Loss: 0.004305
Epoch 98/500, Validation Loss: 0.007395
No significant improvement in validation loss. Early stop count: 1
Epoch 99/500, Training Loss: 0.004293
Epoch 99/500, Validation Loss: 0.007382
No significant improvement in validation loss. Early stop count: 2
Epoch 100/500, Training Loss: 0.004291
Epoch 100/500, Validation Loss: 0.007386
No significant improvement in validation loss. Early stop count: 3
Epoch 101/500, Training Loss: 0.004295
Epoch 101/500, Validation Loss: 0.007364
No significant improvement in validation loss. Early stop count: 4
Epoch 102/500, Training Loss: 0.004284
Epoch 102/500, Validation Loss: 0.007353
No significant improvement in validation loss. Early stop count: 5
Epoch 103/500, Training Loss: 0.004259
Epoch 103/500, Validation Loss: 0.007351
No significant improvement in validation loss. Early stop count: 6
Epoch 104/500, Training Loss: 0.004259
Epoch 104/500, Validation Loss: 0.007342
No significant improvement in validation loss. Early stop count: 7
Epoch 105/500, Training Loss: 0.004245
Epoch 105/500, Validation Loss: 0.007338
No significant improvement in validation loss. Early stop count: 8
Epoch 106/500, Training Loss: 0.004241
Epoch 106/500, Validation Loss: 0.007327
No significant improvement in validation loss. Early stop count: 9
Epoch 107/500, Training Loss: 0.004229
Epoch 107/500, Validation Loss: 0.007319
No significant improvement in validation loss. Early stop count: 10
Epoch 108/500, Training Loss: 0.004235
Epoch 108/500, Validation Loss: 0.007317
No significant improvement in validation loss. Early stop count: 11
Epoch 109/500, Training Loss: 0.004217
Epoch 109/500, Validation Loss: 0.007304
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_109_loss_0.0073.pth
Validation loss improved. Early stop count reset to 0.
Epoch 110/500, Training Loss: 0.004209
Epoch 110/500, Validation Loss: 0.007302
No significant improvement in validation loss. Early stop count: 1
Epoch 111/500, Training Loss: 0.004200
Epoch 111/500, Validation Loss: 0.007287
No significant improvement in validation loss. Early stop count: 2
Epoch 112/500, Training Loss: 0.004190
Epoch 112/500, Validation Loss: 0.007281
No significant improvement in validation loss. Early stop count: 3
Epoch 113/500, Training Loss: 0.004195
Epoch 113/500, Validation Loss: 0.007272
No significant improvement in validation loss. Early stop count: 4
Epoch 114/500, Training Loss: 0.004184
Epoch 114/500, Validation Loss: 0.007270
No significant improvement in validation loss. Early stop count: 5
Epoch 115/500, Training Loss: 0.004187
Epoch 115/500, Validation Loss: 0.007259
No significant improvement in validation loss. Early stop count: 6
Epoch 116/500, Training Loss: 0.004169
Epoch 116/500, Validation Loss: 0.007256
No significant improvement in validation loss. Early stop count: 7
Epoch 117/500, Training Loss: 0.004158
Epoch 117/500, Validation Loss: 0.007246
No significant improvement in validation loss. Early stop count: 8
Epoch 118/500, Training Loss: 0.004166
Epoch 118/500, Validation Loss: 0.007240
No significant improvement in validation loss. Early stop count: 9
Epoch 119/500, Training Loss: 0.004144
Epoch 119/500, Validation Loss: 0.007232
No significant improvement in validation loss. Early stop count: 10
Epoch 120/500, Training Loss: 0.004153
Epoch 120/500, Validation Loss: 0.007223
No significant improvement in validation loss. Early stop count: 11
Epoch 121/500, Training Loss: 0.004138
Epoch 121/500, Validation Loss: 0.007222
No significant improvement in validation loss. Early stop count: 12
Epoch 122/500, Training Loss: 0.004130
Epoch 122/500, Validation Loss: 0.007212
No significant improvement in validation loss. Early stop count: 13
Epoch 123/500, Training Loss: 0.004132
Epoch 123/500, Validation Loss: 0.007209
No significant improvement in validation loss. Early stop count: 14
Epoch 124/500, Training Loss: 0.004127
Epoch 124/500, Validation Loss: 0.007199
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_124_loss_0.0072.pth
Validation loss improved. Early stop count reset to 0.
Epoch 125/500, Training Loss: 0.004111
Epoch 125/500, Validation Loss: 0.007197
No significant improvement in validation loss. Early stop count: 1
Epoch 126/500, Training Loss: 0.004116
Epoch 126/500, Validation Loss: 0.007190
No significant improvement in validation loss. Early stop count: 2
Epoch 127/500, Training Loss: 0.004106
Epoch 127/500, Validation Loss: 0.007183
No significant improvement in validation loss. Early stop count: 3
Epoch 128/500, Training Loss: 0.004098
Epoch 128/500, Validation Loss: 0.007178
No significant improvement in validation loss. Early stop count: 4
Epoch 129/500, Training Loss: 0.004096
Epoch 129/500, Validation Loss: 0.007172
No significant improvement in validation loss. Early stop count: 5
Epoch 130/500, Training Loss: 0.004089
Epoch 130/500, Validation Loss: 0.007165
No significant improvement in validation loss. Early stop count: 6
Epoch 131/500, Training Loss: 0.004079
Epoch 131/500, Validation Loss: 0.007154
No significant improvement in validation loss. Early stop count: 7
Epoch 132/500, Training Loss: 0.004071
Epoch 132/500, Validation Loss: 0.007151
No significant improvement in validation loss. Early stop count: 8
Epoch 133/500, Training Loss: 0.004064
Epoch 133/500, Validation Loss: 0.007145
No significant improvement in validation loss. Early stop count: 9
Epoch 134/500, Training Loss: 0.004062
Epoch 134/500, Validation Loss: 0.007136
No significant improvement in validation loss. Early stop count: 10
Epoch 135/500, Training Loss: 0.004061
Epoch 135/500, Validation Loss: 0.007139
No significant improvement in validation loss. Early stop count: 11
Epoch 136/500, Training Loss: 0.004061
Epoch 136/500, Validation Loss: 0.007129
No significant improvement in validation loss. Early stop count: 12
Epoch 137/500, Training Loss: 0.004038
Epoch 137/500, Validation Loss: 0.007125
No significant improvement in validation loss. Early stop count: 13
Epoch 138/500, Training Loss: 0.004036
Epoch 138/500, Validation Loss: 0.007124
No significant improvement in validation loss. Early stop count: 14
Epoch 139/500, Training Loss: 0.004033
Epoch 139/500, Validation Loss: 0.007112
No significant improvement in validation loss. Early stop count: 15
Epoch 140/500, Training Loss: 0.004023
Epoch 140/500, Validation Loss: 0.007110
No significant improvement in validation loss. Early stop count: 16
Epoch 141/500, Training Loss: 0.004019
Epoch 141/500, Validation Loss: 0.007107
No significant improvement in validation loss. Early stop count: 17
Epoch 142/500, Training Loss: 0.004023
Epoch 142/500, Validation Loss: 0.007096
Best model saved to result/TRANSFORMER_False_equal_risk_parity_60_20/models/best_model_epoch_142_loss_0.0071.pth
Validation loss improved. Early stop count reset to 0.
Epoch 143/500, Training Loss: 0.004018
Epoch 143/500, Validation Loss: 0.007089
No significant improvement in validation loss. Early stop count: 1
Epoch 144/500, Training Loss: 0.004019
Epoch 144/500, Validation Loss: 0.007087
No significant improvement in validation loss. Early stop count: 2
Epoch 145/500, Training Loss: 0.004009
Epoch 145/500, Validation Loss: 0.007079
No significant improvement in validation loss. Early stop count: 3
Epoch 146/500, Training Loss: 0.004009
Epoch 146/500, Validation Loss: 0.007080
No significant improvement in validation loss. Early stop count: 4
Epoch 147/500, Training Loss: 0.004005
Epoch 147/500, Validation Loss: 0.007074
No significant improvement in validation loss. Early stop count: 5
Epoch 148/500, Training Loss: 0.004003
Epoch 148/500, Validation Loss: 0.007066
No significant improvement in validation loss. Early stop count: 6
Epoch 149/500, Training Loss: 0.003992
Epoch 149/500, Validation Loss: 0.007064
No significant improvement in validation loss. Early stop count: 7
Epoch 150/500, Training Loss: 0.003988
Epoch 150/500, Validation Loss: 0.007061
No significant improvement in validation loss. Early stop count: 8
Epoch 151/500, Training Loss: 0.003985
Epoch 151/500, Validation Loss: 0.007056
No significant improvement in validation loss. Early stop count: 9
Epoch 152/500, Training Loss: 0.003964
Epoch 152/500, Validation Loss: 0.007048
No significant improvement in validation loss. Early stop count: 10
Epoch 153/500, Training Loss: 0.003979
Epoch 153/500, Validation Loss: 0.007036
No significant improvement in validation loss. Early stop count: 11
Epoch 154/500, Training Loss: 0.003965
Epoch 154/500, Validation Loss: 0.007040
No significant improvement in validation loss. Early stop count: 12
Epoch 155/500, Training Loss: 0.003971
Epoch 155/500, Validation Loss: 0.007034
No significant improvement in validation loss. Early stop count: 13
Epoch 156/500, Training Loss: 0.003961
Epoch 156/500, Validation Loss: 0.007027
No significant improvement in validation loss. Early stop count: 14
Epoch 157/500, Training Loss: 0.003961
Epoch 157/500, Validation Loss: 0.007023
No significant improvement in validation loss. Early stop count: 15
Epoch 158/500, Training Loss: 0.003952
Epoch 158/500, Validation Loss: 0.007025
No significant improvement in validation loss. Early stop count: 16
Epoch 159/500, Training Loss: 0.003949
Epoch 159/500, Validation Loss: 0.007020
No significant improvement in validation loss. Early stop count: 17
Epoch 160/500, Training Loss: 0.003942
Epoch 160/500, Validation Loss: 0.007011
No significant improvement in validation loss. Early stop count: 18
Epoch 161/500, Training Loss: 0.003939
Epoch 161/500, Validation Loss: 0.007020
No significant improvement in validation loss. Early stop count: 19
Epoch 162/500, Training Loss: 0.003943
Epoch 162/500, Validation Loss: 0.007014
No significant improvement in validation loss. Early stop count: 20
Early stopping at epoch 162 after 20 epochs without significant improvement.
Configuration: {'START': '2001-01-01', 'END': '2024-09-01', 'N_STOCK': 50, 'LEN_DATA': 5000, 'TRAIN_LEN': 60, 'PRED_LEN': 20, 'TRAIN_RATIO': 0.6, 'VAL_RATIO': 0.2, 'TEST_RATIO': 0.2, 'RESULT_DIR': 'result/TRANSFORMER_False_mean_variance_60_20', 'MODELS': ['GRU', 'TCN', 'TRANSFORMER'], 'MULTIMODAL_OPTIONS': [False], 'LOSS_FUNCTIONS': ['max_sharpe', 'equal_risk_parity', 'mean_variance'], 'TRAIN_LEN_OPTIONS': [60], 'PRED_LEN_OPTIONS': [20], 'SEED': 42, 'BATCH': 32, 'EPOCHS': 500, 'EARLY_STOP': 20, 'MIN_DELTA': 0.0001, 'LR': 0.005, 'MOMENTUM': 0.9, 'USE_CUDA': True, 'LB': 0, 'UB': 0.2, 'N_FEAT': 50, 'BETA': 0.2, 'LOSS_FUNCTION': 'mean_variance', 'TCN': {'n_output': 50, 'kernel_size': 4, 'n_dropout': 0.1, 'n_timestep': 60, 'hidden_size': 64, 'level': 3}, 'GRU': {'n_layers': 1, 'hidden_dim': 128, 'dropout_p': 0.3, 'bidirectional': False}, 'TRANSFORMER': {'n_timestep': 60, 'n_layer': 6, 'n_head': 5, 'n_dropout': 0.1, 'n_output': 50}, 'MODEL': 'TRANSFORMER', 'MULTIMODAL': False}
Model: transformer, Multimodal: False, Loss Function: mean_variance
Loading and processing data...
Epoch 1/500, Training Loss: 0.045706
Epoch 1/500, Validation Loss: 0.047086
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_1_loss_0.0471.pth
Validation loss improved. Early stop count reset to 0.
Epoch 2/500, Training Loss: 0.037415
Epoch 2/500, Validation Loss: 0.044649
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_2_loss_0.0446.pth
Validation loss improved. Early stop count reset to 0.
Epoch 3/500, Training Loss: 0.033264
Epoch 3/500, Validation Loss: 0.043371
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_3_loss_0.0434.pth
Validation loss improved. Early stop count reset to 0.
Epoch 4/500, Training Loss: 0.030888
Epoch 4/500, Validation Loss: 0.042359
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_4_loss_0.0424.pth
Validation loss improved. Early stop count reset to 0.
Epoch 5/500, Training Loss: 0.029992
Epoch 5/500, Validation Loss: 0.042428
No significant improvement in validation loss. Early stop count: 1
Epoch 6/500, Training Loss: 0.029855
Epoch 6/500, Validation Loss: 0.042286
No significant improvement in validation loss. Early stop count: 2
Epoch 7/500, Training Loss: 0.029469
Epoch 7/500, Validation Loss: 0.042042
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_7_loss_0.0420.pth
Validation loss improved. Early stop count reset to 0.
Epoch 8/500, Training Loss: 0.029356
Epoch 8/500, Validation Loss: 0.041871
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_8_loss_0.0419.pth
Validation loss improved. Early stop count reset to 0.
Epoch 9/500, Training Loss: 0.028978
Epoch 9/500, Validation Loss: 0.041767
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_9_loss_0.0418.pth
Validation loss improved. Early stop count reset to 0.
Epoch 10/500, Training Loss: 0.028779
Epoch 10/500, Validation Loss: 0.041694
No significant improvement in validation loss. Early stop count: 1
Epoch 11/500, Training Loss: 0.028975
Epoch 11/500, Validation Loss: 0.041657
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_11_loss_0.0417.pth
Validation loss improved. Early stop count reset to 0.
Epoch 12/500, Training Loss: 0.028532
Epoch 12/500, Validation Loss: 0.041623
No significant improvement in validation loss. Early stop count: 1
Epoch 13/500, Training Loss: 0.028961
Epoch 13/500, Validation Loss: 0.041603
No significant improvement in validation loss. Early stop count: 2
Epoch 14/500, Training Loss: 0.028569
Epoch 14/500, Validation Loss: 0.041584
No significant improvement in validation loss. Early stop count: 3
Epoch 15/500, Training Loss: 0.028638
Epoch 15/500, Validation Loss: 0.041571
No significant improvement in validation loss. Early stop count: 4
Epoch 16/500, Training Loss: 0.028579
Epoch 16/500, Validation Loss: 0.041549
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_16_loss_0.0415.pth
Validation loss improved. Early stop count reset to 0.
Epoch 17/500, Training Loss: 0.028533
Epoch 17/500, Validation Loss: 0.041531
No significant improvement in validation loss. Early stop count: 1
Epoch 18/500, Training Loss: 0.028445
Epoch 18/500, Validation Loss: 0.041511
No significant improvement in validation loss. Early stop count: 2
Epoch 19/500, Training Loss: 0.028615
Epoch 19/500, Validation Loss: 0.041500
No significant improvement in validation loss. Early stop count: 3
Epoch 20/500, Training Loss: 0.028365
Epoch 20/500, Validation Loss: 0.041491
No significant improvement in validation loss. Early stop count: 4
Epoch 21/500, Training Loss: 0.028457
Epoch 21/500, Validation Loss: 0.041471
No significant improvement in validation loss. Early stop count: 5
Epoch 22/500, Training Loss: 0.028380
Epoch 22/500, Validation Loss: 0.041452
No significant improvement in validation loss. Early stop count: 6
Epoch 23/500, Training Loss: 0.028377
Epoch 23/500, Validation Loss: 0.041446
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_23_loss_0.0414.pth
Validation loss improved. Early stop count reset to 0.
Epoch 24/500, Training Loss: 0.028357
Epoch 24/500, Validation Loss: 0.041430
No significant improvement in validation loss. Early stop count: 1
Epoch 25/500, Training Loss: 0.028586
Epoch 25/500, Validation Loss: 0.041415
No significant improvement in validation loss. Early stop count: 2
Epoch 26/500, Training Loss: 0.028210
Epoch 26/500, Validation Loss: 0.041400
No significant improvement in validation loss. Early stop count: 3
Epoch 27/500, Training Loss: 0.028140
Epoch 27/500, Validation Loss: 0.041368
No significant improvement in validation loss. Early stop count: 4
Epoch 28/500, Training Loss: 0.028160
Epoch 28/500, Validation Loss: 0.041358
No significant improvement in validation loss. Early stop count: 5
Epoch 29/500, Training Loss: 0.028260
Epoch 29/500, Validation Loss: 0.041341
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_29_loss_0.0413.pth
Validation loss improved. Early stop count reset to 0.
Epoch 30/500, Training Loss: 0.028152
Epoch 30/500, Validation Loss: 0.041330
No significant improvement in validation loss. Early stop count: 1
Epoch 31/500, Training Loss: 0.028061
Epoch 31/500, Validation Loss: 0.041314
No significant improvement in validation loss. Early stop count: 2
Epoch 32/500, Training Loss: 0.028079
Epoch 32/500, Validation Loss: 0.041299
No significant improvement in validation loss. Early stop count: 3
Epoch 33/500, Training Loss: 0.027973
Epoch 33/500, Validation Loss: 0.041261
No significant improvement in validation loss. Early stop count: 4
Epoch 34/500, Training Loss: 0.027968
Epoch 34/500, Validation Loss: 0.041268
No significant improvement in validation loss. Early stop count: 5
Epoch 35/500, Training Loss: 0.027794
Epoch 35/500, Validation Loss: 0.041245
No significant improvement in validation loss. Early stop count: 6
Epoch 36/500, Training Loss: 0.027949
Epoch 36/500, Validation Loss: 0.041246
No significant improvement in validation loss. Early stop count: 7
Epoch 37/500, Training Loss: 0.027893
Epoch 37/500, Validation Loss: 0.041216
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_37_loss_0.0412.pth
Validation loss improved. Early stop count reset to 0.
Epoch 38/500, Training Loss: 0.027697
Epoch 38/500, Validation Loss: 0.041201
No significant improvement in validation loss. Early stop count: 1
Epoch 39/500, Training Loss: 0.027752
Epoch 39/500, Validation Loss: 0.041181
No significant improvement in validation loss. Early stop count: 2
Epoch 40/500, Training Loss: 0.027767
Epoch 40/500, Validation Loss: 0.041158
No significant improvement in validation loss. Early stop count: 3
Epoch 41/500, Training Loss: 0.027724
Epoch 41/500, Validation Loss: 0.041140
No significant improvement in validation loss. Early stop count: 4
Epoch 42/500, Training Loss: 0.027927
Epoch 42/500, Validation Loss: 0.041121
No significant improvement in validation loss. Early stop count: 5
Epoch 43/500, Training Loss: 0.028016
Epoch 43/500, Validation Loss: 0.041113
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_43_loss_0.0411.pth
Validation loss improved. Early stop count reset to 0.
Epoch 44/500, Training Loss: 0.027607
Epoch 44/500, Validation Loss: 0.041094
No significant improvement in validation loss. Early stop count: 1
Epoch 45/500, Training Loss: 0.027832
Epoch 45/500, Validation Loss: 0.041083
No significant improvement in validation loss. Early stop count: 2
Epoch 46/500, Training Loss: 0.027605
Epoch 46/500, Validation Loss: 0.041082
No significant improvement in validation loss. Early stop count: 3
Epoch 47/500, Training Loss: 0.027690
Epoch 47/500, Validation Loss: 0.041073
No significant improvement in validation loss. Early stop count: 4
Epoch 48/500, Training Loss: 0.027495
Epoch 48/500, Validation Loss: 0.041061
No significant improvement in validation loss. Early stop count: 5
Epoch 49/500, Training Loss: 0.027552
Epoch 49/500, Validation Loss: 0.041045
No significant improvement in validation loss. Early stop count: 6
Epoch 50/500, Training Loss: 0.027612
Epoch 50/500, Validation Loss: 0.041057
No significant improvement in validation loss. Early stop count: 7
Epoch 51/500, Training Loss: 0.027404
Epoch 51/500, Validation Loss: 0.041035
No significant improvement in validation loss. Early stop count: 8
Epoch 52/500, Training Loss: 0.027313
Epoch 52/500, Validation Loss: 0.041054
No significant improvement in validation loss. Early stop count: 9
Epoch 53/500, Training Loss: 0.027392
Epoch 53/500, Validation Loss: 0.041043
No significant improvement in validation loss. Early stop count: 10
Epoch 54/500, Training Loss: 0.027583
Epoch 54/500, Validation Loss: 0.041041
No significant improvement in validation loss. Early stop count: 11
Epoch 55/500, Training Loss: 0.027260
Epoch 55/500, Validation Loss: 0.041029
No significant improvement in validation loss. Early stop count: 12
Epoch 56/500, Training Loss: 0.027208
Epoch 56/500, Validation Loss: 0.041038
No significant improvement in validation loss. Early stop count: 13
Epoch 57/500, Training Loss: 0.027285
Epoch 57/500, Validation Loss: 0.041022
No significant improvement in validation loss. Early stop count: 14
Epoch 58/500, Training Loss: 0.027260
Epoch 58/500, Validation Loss: 0.041011
Best model saved to result/TRANSFORMER_False_mean_variance_60_20/models/best_model_epoch_58_loss_0.0410.pth
Validation loss improved. Early stop count reset to 0.
Epoch 59/500, Training Loss: 0.027088
Epoch 59/500, Validation Loss: 0.041010
No significant improvement in validation loss. Early stop count: 1
Epoch 60/500, Training Loss: 0.027107
Epoch 60/500, Validation Loss: 0.041025
No significant improvement in validation loss. Early stop count: 2
Epoch 61/500, Training Loss: 0.027125
Epoch 61/500, Validation Loss: 0.041024
No significant improvement in validation loss. Early stop count: 3
Epoch 62/500, Training Loss: 0.027426
Epoch 62/500, Validation Loss: 0.041031
No significant improvement in validation loss. Early stop count: 4
Epoch 63/500, Training Loss: 0.027037
Epoch 63/500, Validation Loss: 0.041031
No significant improvement in validation loss. Early stop count: 5
Epoch 64/500, Training Loss: 0.027090
Epoch 64/500, Validation Loss: 0.041026
No significant improvement in validation loss. Early stop count: 6
Epoch 65/500, Training Loss: 0.027347
Epoch 65/500, Validation Loss: 0.041026
No significant improvement in validation loss. Early stop count: 7
Epoch 66/500, Training Loss: 0.027022
Epoch 66/500, Validation Loss: 0.041050
No significant improvement in validation loss. Early stop count: 8
Epoch 67/500, Training Loss: 0.026973
Epoch 67/500, Validation Loss: 0.041035
No significant improvement in validation loss. Early stop count: 9
Epoch 68/500, Training Loss: 0.027217
Epoch 68/500, Validation Loss: 0.041065
No significant improvement in validation loss. Early stop count: 10
Epoch 69/500, Training Loss: 0.027208
Epoch 69/500, Validation Loss: 0.041069
No significant improvement in validation loss. Early stop count: 11
Epoch 70/500, Training Loss: 0.027149
Epoch 70/500, Validation Loss: 0.041040
No significant improvement in validation loss. Early stop count: 12
Epoch 71/500, Training Loss: 0.026929
Epoch 71/500, Validation Loss: 0.041033
No significant improvement in validation loss. Early stop count: 13
Epoch 72/500, Training Loss: 0.026916
Epoch 72/500, Validation Loss: 0.041034
No significant improvement in validation loss. Early stop count: 14
Epoch 73/500, Training Loss: 0.027175
Epoch 73/500, Validation Loss: 0.041024
No significant improvement in validation loss. Early stop count: 15
Epoch 74/500, Training Loss: 0.026964
Epoch 74/500, Validation Loss: 0.041027
No significant improvement in validation loss. Early stop count: 16
Epoch 75/500, Training Loss: 0.026952
Epoch 75/500, Validation Loss: 0.041024
No significant improvement in validation loss. Early stop count: 17
Epoch 76/500, Training Loss: 0.026776
Epoch 76/500, Validation Loss: 0.041006
No significant improvement in validation loss. Early stop count: 18
Epoch 77/500, Training Loss: 0.026789
Epoch 77/500, Validation Loss: 0.041003
No significant improvement in validation loss. Early stop count: 19
Epoch 78/500, Training Loss: 0.026807
Epoch 78/500, Validation Loss: 0.041000
No significant improvement in validation loss. Early stop count: 20
Early stopping at epoch 78 after 20 epochs without significant improvement.
