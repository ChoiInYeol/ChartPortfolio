Model Path: Result/GRU
Loading model: False_GRU_50_12_loss_0.4568.pth
Data loading completed
Test data shape - X: (1577, 60, 370), Y: (1577, 20, 370), Prob: (1577, 20, 370)
Loading test data...
Error loading test data: [Errno 2] No such file or directory: 'data/dataset.pkl'
Traceback: Traceback (most recent call last):
  File "/home/indi/codespace/ImagePortOpt/TS_Model/inference.py", line 196, in _load_test_data
    with open("data/dataset.pkl", "rb") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/dataset.pkl'

Error during inference: [Errno 2] No such file or directory: 'data/dataset.pkl'
Traceback: Traceback (most recent call last):
  File "/home/indi/codespace/ImagePortOpt/TS_Model/inference.py", line 295, in infer
    self._load_test_data()
  File "/home/indi/codespace/ImagePortOpt/TS_Model/inference.py", line 196, in _load_test_data
    with open("data/dataset.pkl", "rb") as f:
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'data/dataset.pkl'

Input shapes - x: N/A, prob: N/A
Empty weights array received
Configuration: {'START': '2001-01-01', 'END': '2024-08-01', 'LEN_DATA': 5000, 'N_STOCK': 370, 'N_SELECT': 50, 'TRAIN_LEN': 60, 'PRED_LEN': 20, 'TRAIN_START_DATE': '2001-01-01', 'TRAIN_END_DATE': '2017-12-31', 'TRAIN_RATIO': 0.7, 'VALIDATION_RATIO': 0.3, 'TEST_START_DATE': '2018-01-01', 'TEST_END_DATE': '2024-08-01', 'RESULT_DIR': 'Result', 'MODEL': 'GRU', 'BATCH': 128, 'EPOCHS': 500, 'EARLY_STOP': 10, 'LR': 0.001, 'MOMENTUM': 0.9, 'USE_CUDA': True, 'SEED': 42, 'LB': 0, 'UB': 0.2, 'LOSS_FUNCTION': 'max_sharpe', 'N_LAYER': 1, 'HIDDEN_DIM': 128, 'N_HEAD': 10, 'N_FEAT': 370, 'DROPOUT': 0.3, 'BIDIRECTIONAL': False, 'TCN': {'n_timestep': 60, 'n_output': 370, 'kernel_size': 4, 'n_dropout': 0.1, 'hidden_size': 64, 'level': 3, 'channels': [64, 64, 64]}, 'TRANSFORMER': {'n_timestep': 60, 'n_output': 370, 'n_layer': 6, 'n_head': 5, 'n_dropout': 0.1}, 'MODEL_TYPE': '2D', 'PERIOD': 'month', 'WINDOW_SIZE': 20, 'PRED_WINDOW': 20, 'DATASET_PATH': '/home/indi/codespace/ImagePortOpt/TS_Model/data/dataset_2D_month_20D_20P.pkl', 'DATES_PATH': '/home/indi/codespace/ImagePortOpt/TS_Model/data/dates_2D_month_20D_20P.pkl'}
Model Path: Result/GRU
Loading model: False_GRU_50_12_loss_0.4568.pth
Data loading completed
Test data shape - X: (1577, 60, 370), Y: (1577, 20, 370), Prob: (1577, 20, 370)
Loading test data...
First few dates after processing: [Timestamp('2018-04-26 00:00:00'), Timestamp('2018-04-27 00:00:00'), Timestamp('2018-04-30 00:00:00'), Timestamp('2018-05-01 00:00:00'), Timestamp('2018-05-02 00:00:00')]
Total dates: 1577
Validating test data...
Test data shape - X: (1577, 60, 370), Y: (1577, 20, 370), Prob: (1577, 20, 370)
Test dates length: 1577
Test data loading completed
Test data loaded: 1577 samples
Loaded 370 tickers from /home/indi/codespace/ImagePortOpt/Data/return_df.csv
Converting dates from type <class 'list'> to DatetimeIndex
Weights array shape: (1577, 370)
Expected shape: (1577, 370)
Weights saved to Result/GRU/weights_False_GRU_n50_t60_p20_loss0.4663.csv
Model parameters:
- Use prob: False
- Model: GRU
- N_select: 50
- Train length: 60
- Pred length: 20
- Model loss: 0.4663
